import"../../web_modules/imba/dist/imba.js";function c(F,Q){var U=Object.getOwnPropertyDescriptors(Q);return Object.defineProperties(F.prototype,U),F}class s{constructor(F,Q,U,B={}){this.node=F,this.route=F.router.routeFor(F,Q,U?U.route:null,B),this.match=null,this.options=B,this.placeholder=F.$placeholder||new Comment(""+Q)}get raw(){return this.route.raw}set path(F){this.route.path=F}get params(){return this.match}get sticky(){return this.options&&this.options.sticky}get exact(){return this.options&&this.options.exact}isActive(){return this.match&&this.match.active}resolve(){let F=this.match,Q=F&&F.url,U=this.route.test();if(U){let B=F&&F.active;return U.active=!0,U!=F&&(this.match=U),(U!=F||!B||U.url!=Q)&&this.resolved(U,F,Q),B||this.enter(),U}else F&&F.active?(F.active=!1,this.leave()):F||(this.match=F={},this.leave());return F}enter(){var F;return this.node.flags.remove("not-routed"),this.node.flags.add("routed"),(F=this.node)&&F.routeDidEnter&&F.routeDidEnter(this)}resolved(F,Q,U){var B;return(B=this.node)&&B.routeDidResolve&&B.routeDidResolve(F,Q,U)}leave(){var F;return this.node.flags.add("not-routed"),this.node.flags.remove("routed"),(F=this.node)&&F.routeDidLeave&&F.routeDidLeave(this)}}class R extends s{enter(){return this}resolve(){return this.url=this.route.resolve(),super.resolve(...arguments)}resolved(){return this}leave(){return this}go(){let F=this.route.resolve();return this.sticky&&this.match&&!this.match.active&&(F=this.match.url||F),this.options&&this.options.replace?this.node.router.replace(F):this.node.router.go(F)}}c(Element,{get route(){return this.$route},get parentRoute(){return this.$context.route},set route(F){var Q=this;if(this.$route&&this.$route.raw!=F){this.$route.path=F;return}let U=F[0]!="/"?this.parentRoute:null;this.$route=new s(this,F,U,this.route__),this.end$=this.end$routed,this.insertInto$=function(B){return B.appendChild$(Q.$route.isActive()?Q:Q.$route.placeholder)}},set routeTo(F){var Q=this;if(this.$route){this.$route.raw!=F&&(this.$route.path=F);return}let U=F[0]!="/"?this.parentRoute:null;this.$route=this.$routeTo=new R(this,F,U,this.routeTo__),this.end$=this.end$routeTo,this.onclick=function(B){if(!B.altKey&&!B.metaKey)return B.preventDefault(),Q.$route.go()}},end$routed(){if(this.$route&&(this.$route.resolve(),!this.$route.isActive()))return;if(this.visit)return this.visit()},end$routeTo(){if(this.$route){let F=this.$route.resolve(),Q=this.$route.url;this.$route.sticky&&F.url&&(Q=F.url),this.nodeName=="A"&&this.setAttribute("href",Q),this.flags.toggle("active",F&&F.active||!1)}if(this.visit)return this.visit()},routeDidEnter(F){let Q=F.placeholder;if(Q.parentNode&&Q!=this)return Q.replaceWith$(this)},routeDidLeave(F){let Q=F.placeholder;return this.parentNode&&Q!=this&&this.replaceWith$(Q),this},routeDidResolve(F,Q){var U=this;return;if(!this.load||F==Q&&!this.reload)return this&&this.routeDidMatch&&this.routeDidMatch(F),this&&this.routeDidLoad&&this.routeDidLoad(F,Q),this}});
